<%- include('../partials/header') %>

      
    <div class="card">
      <div class="card-header">
        <a href="/projects/<%= project._id %>/edit" class="btn btn-secondary">Edit</a>
           Priority: <%= project.priority %>
      </div>
      <div class="card-body">
        <h2 class="card-title text-center"><%= project.title %> </h2>
        <h6 class="card-text text-center">
          <%= project.description %> 
        </h6>
        
        <ul class="list-group">
          <li class="list-group-item">Manager: <%= project.projectManager.name %> </li>
          <li class="list-group-item">userCreated: <%= project.userCreated.name %> </li>
          <li class="list-group-item">type: <%= project.type %> </li>
          <li class="list-group-item">Team:
            <ul class="listgroup">
              <% project.usersAssigned.forEach(function(user) { %> 
                <li class="list-group-item"> <%= user.name %> - <%= user.email %> </li>

              <% }) %> 
            </ul>
          </li>
          <li class="list-group-item">Rocks:
            <ul>
              <% project.rocks.forEach(function(rock) { %> 
                <li class="list-group-item"> <%= rock.title %> </li>

              <% }) %> 
            </ul>
          </li>
        </ul>
      ==============================================================
        <div class="row row-cols-3 row-cols-md-3 g-4">
          <% rocks.forEach(function(rock) { %>
            <% if (user && user._id.equals(rock.userId) && project._id.equals(rock.projectId)) { %>    
              <div class="col">

                <div class="card h-100 text-center">
                  <div class="card-header">
                    <h5 class="card-title"><%= rock.title %></h5>
                  </div>
                  <div class="card-body">
                    <p class="card-text"><%= rock.description %> </p>
                    <div class="card-text"> Category: <%= rock.category %> </div>
                  </div>
                  <div class="card-footer">
                      <img alt="avatar" src="<%= rock.userAvatar %>" referrerpolicy="no-referrer">
                      <h6 class="card-text"> <%= rock.userName %> </h6>
                  </div>
                  <div class="card-footer text-muted">
                    Created by: <%= project.userCreated %> (change to 'userCreatedName') on <%= project.createdAt.toLocaleDateString() %> 
                  </div>
                </div>
              </div>
                  <!--  END OF ROCKScard -->
            <% }  %>
          <% }); %> 
          <!--END OF ROCKS for each -->
          </div>
        </div> 
        <div class="row row-cols-1 row-cols-md-3 g-4">
                <!-- START ROCKS CARD -->
          
          <% project.rocks.forEach(function(rock) { %> 
            <div class="col">
              <div class="card h-100" >
                <div class="card-body">
                  <h5 class="card-title"><%= rock.title %> </h5>
                  <p class="card-text"> <%= rock.description %> </p>
                </div>
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">Category: <%= rock.category %> </li>
                  <li class="list-group-item">Priority: <%= rock.priority %> </li>
                  <li class="list-group-item">Diffuculty: <%= rock.difficulty %> </li>
                  <li class="list-group-item">Complete: <%= rock.complete %> </li>
                  <li class="list-group-item">Progress: <%= rock.progress %> </li>
                  <li class="list-group-item">
                  <li class="list-group-item">
                    <p class="list-text">Note: <%= rock.userNotes %> </p>
                  </li>
                </ul>

                <div class="card-body">
                  <% if (rock.userId.equals(user._id)) {%> 
                    <p class="card-text">Assigned
                      <a href="/rocks/<%= rock.id %>/edit" class="card-link">edit</a>
                    </p>
                  <% } else {%>
                    <p class="card-text">Assigned to <%= rock.userName %> </p>
                    <% } %> 
    
                      
                </div>
              </div>
            </div>
          <!-- END OF ROCKS CARD -->
          <% }) %> 
        </div> <!-- END row class at start of card-->
      </div>
      <!--  END OF CARDbody -->

    </div>
    <!-- END OF CARD -->




======================================================================================
  <table class="table table table-success table-striped table-hover table-bordered">
    <thead>
      <tr>
        <th>Created</th>
        <th>title</th>
        <th>type</th>
        <th>priority</th>
        <th>Creator</th>

      </tr>
    </thead>
    <tbody>
            <tr>
              <td><%= project.createdAt.toLocaleDateString() %> </td>
              <td><a href="/projects/<%= project._id %>"> <%= project.title %></a></td>
              <td><%= project.type %></td>
              <td><%= project.priority %> </td>
              <td><%= project.userCreatedName %> </td>
              <td><%= project.projectManager %> - <%= project.projectManagerName %></td>
            </tr>
            <tr>
              <td>Team:<%= project.usersAssigned %></td>
              <td>Rocks: <%= project.rocks %></td>
            </tr>


        

    </tbody>
  </table>




<section id="show-page">
  <%= project.title %>
  <small>Creator: <%= project.userCreated.name %> </small>
  <small>Type: <%= project.priority %></small>
  <a href="/projects/<%= project._id %>/edit">edit</a>

  <div>Team:
    <ul>
      <% project.usersAssigned.forEach(user=> { %>
        <li> 
          <small><%= user.name %> </small>
        </li>
      
        <% }) %>
    </ul>
  </div>
 ==============================================================================  
 ==============================================================================  

  <!-- END OF TEAM USERS ASSIGNED LIST -->
  <div>Rocks:
    <% rocks.forEach(r=> { %>
      <table>
        <thead>
          <tr><th><img alt="avatar" src="<%= r.userAvatar %>" referrerpolicy="no-referrer"></th></tr>
          <tr><th><small> <%= r.userName %>'s rock</small></th></tr>
          <tr>
            <th>Title: </th>
            <th> Description</th>
            <th> Priority</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><%= r.title %> </td>
            <td> <%= r.description %> </td>
            <td> <%= r.priority %> </td>
            
          </tr>
        </tbody>
        <% if (user && user._id.equals(r.userId)) { %>
          <tfoot>
            <tr>
              <td>
                <form action="/rocks/<%= r.id %>?_method=DELETE" method="POST">
                  <button type="submit">DELETE</button>
                </form>
              </td>
              <td>
                <a href="/rocks/<%= r.id %>/edit">edit</a>
              </td>
            </tr>
          </tfoot>
        <% } %> 
    </table>
    <% }) %>
  </div>
  <!-- END OF ROCKS LIST -->
</section>
==============================================================================  
==============================================================================  
<!-- END OF SHOW-PAGE SECTION -->
<section>
  <h3>Add Rock</h3>
  <form id="add-review-form" method="POST"
  action="/projects/<%= project._id %>/rocks">
    <label>Title:</label>
      <input type="text" name="title">
      <br>
    <label>Description:</label>
      <textarea name="description"></textarea>
      <br>
    <label>Category:</label>
      <select name="category" id="">
        <option value="Personal">Personal</option>
        <option value="Project">Project</option>
        <option value="Private">Private</option>
      </select>
      <br>
    <label>Priority:</label>
      <select name="piority" id="">
        <option value="name">High</option>
        <option value="Moderate">Moderate</option>
        <option value="Low">Low</option>
        <option> test</option>
      </select>
      <br>
    <label>Difficulty</label>
      <input type="Number" name="difficulty">
  <br>
    <label>AsignUser-dropdown of allusers:</label>
      <select name="userId">
        <option></option>
      </select>
    
      <br>
    <input type="submit" value="Add">

  
</form>
</section>


<%- include('../partials/footer') %>